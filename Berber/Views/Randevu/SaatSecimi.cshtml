@{
    ViewData["Title"] = "3. Adım: Tarih ve Saat Seçimi";
    var calisanAd = ViewData["CalisanAd"];
    var hizmetAd = ViewData["HizmetAd"];
    var hizmetSure = ViewData["HizmetSuresi"];
    var musaitSaatler = ViewData["MusaitSaatler"] as List<string>;
    var calisanId = ViewData["CalisanId"];
    var hizmetId = ViewData["HizmetId"];
    var salonId = ViewData["SalonId"];
}

<h2 class="text-center mb-4">3. Adım: Tarih ve Saat Seçimi</h2>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger text-center">
        @TempData["ErrorMessage"]
    </div>
}

<hr />

<div class="alert alert-info">
    <p>
        <strong>Seçilen Çalışan:</strong> @calisanAd
    </p>
    <p>
        <strong>Seçilen Hizmet:</strong> @hizmetAd (@hizmetSure dakika)
    </p>
</div>


<div class="row">
    <div class="col-md-12">
        <form asp-action="SaatSecimi" method="get">
            <input type="hidden" name="CalisanId" value="@ViewData["CalisanId"]" />
            <input type="hidden" name="HizmetId" value="@ViewData["HizmetId"]" />
            <input type="hidden" name="SalonId" value="@ViewData["SalonId"]" />

            <div class="form-group mb-4">
                <label name="secilenTarih" class="control-label">Randevu Tarihi</label>
                <div class="input-group">
                    <input type="date"
                           name="secilenTarih"
                           class="form-control"
                           value="@ViewData["SecilenTarih"]"
                           min="@DateTime.Today.ToString("yyyy-MM-dd")"
                           onchange="this.form.submit()" required />
                </div>
            </div>
        </form>

        <form asp-action="RandevuOnay" method="post">
            <input type="hidden" name="CalisanId" value="@ViewData["CalisanId"]" />
            <input type="hidden" name="HizmetId" value="@ViewData["HizmetId"]" />
            <input type="hidden" name="SalonId" value="@ViewData["SalonId"]" />
            <input type="hidden" name="SecilenTarih" value="@ViewData["SecilenTarih"]" />

            <h4>Müsait Saatler:</h4>

            <div class="d-flex flex-wrap gap-2 mb-4">
                @if (ViewData["MusaitSaatler"] is List<string> musaitSaatler && musaitSaatler.Any())
                {
                    @foreach (var saat in musaitSaatler)
                    {
                        <input type="radio" id="saat_@saat.Replace(":", "")" name="SecilenSaat" value="@saat" class="btn-check" autocomplete="off" required />
                        <label class="btn btn-outline-primary" for="saat_@saat.Replace(":", "")">@saat</label>
                    }
                }
                else
                {
                    <div class="alert alert-warning w-100">Seçilen tarihte müsait zaman dilimi bulunamadı. Lütfen başka bir gün seçiniz.</div>
                }
            </div>

            <div class="form-group">
                <button type="submit" class="btn btn-success btn-lg">Randevuyu Onayla ve Bitir</button>
            </div>
        </form>

        <a asp-action="CalisanSec" asp-route-hizmetId="@ViewData["HizmetId"]" asp-route-salonId="@ViewData["SalonId"]" class="btn btn-link mt-3">
            <i class="fa-solid fa-arrow-left"></i> Çalışan Seçimine Geri Dön
        </a>
    </div>
</div>